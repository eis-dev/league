const router=new VueRouter({routes:[{path:"/",component:this},{path:"/:id",component:this},{path:"/:id/:league",component:this}]});var app=new Vue({router:router,el:"#app",data:{list:{},name:"",league:"",teams:[],values:{},scores:[],t_sort:[],newleague:!1,time1:!1,load:!1,updated_at:"",created_at:"",up:!1,getid:!1},computed:{time2(){let e=[];for(let t in this.time1)e.push([this.time1[t][1],this.time1[t][0]]);return e},matches(){return[this.time1,this.time2]},safe_url(){let e=window.location.href.split("#")[0];return e=e.split("?")[0]}},methods:{go:function(e){this.load=!1,setTimeout(function(){window.location.href=e},500)},goBack:function(){this.go(this.safe_url+"?"+this.$route.params.id+"#/"+this.$route.params.id)},goHome:function(){let e=window.location.href.split("#")[0];e=e.split("?")[0]+"?#/",this.go(e)},join:function(){this.getid&&this.getid.length>5?this.go(this.safe_url+"?"+this.getid+"#/"+this.getid):(alert("ID en az 6 karakter olmalı."),this.getId=!1)},del:function(){1==confirm(this.league[0].toUpperCase()+this.league.slice(1)+" ligi silinsin mi?")&&axios.delete("https://lig123.firebaseio.com/id/"+this.$route.params.id+"/"+this.name+".json").then(e=>{this.goBack()})},to_string:function(e){return e?e.toString().replace(/,/g,", "):""},getScores:function(){let e=[],t=document.getElementsByClassName("match");for(let s=0;s<t.length;s++)e.push(t[s].getElementsByTagName("input")[0].value+"-"+t[s].getElementsByTagName("input")[1].value);this.scores=e},suffle:function(e){let t,s,a;for(a=e.length-1;a>0;a--)t=Math.floor(Math.random()*(a+1)),s=e[a],e[a]=e[t],e[t]=s;return e},sort:function(){let e=this,t={},s=[],a=[],i=[];for(let s in e.values.p){let a=e.values.p[s];t[a]+="-"+s,t[a]=t[a].replace("undefined-","")}for(let e in t)t[e].includes("-")&&s.push(t[e]);for(let e in s){let t=[],i=s[e].split("-");for(let e in i){for(let s in i)i[e]===i[s]||t.includes(i[s])||(a.push(i[e]+"_"+i[s]),a.push(i[s]+"_"+i[e]));t.push(i[e])}}let l=0;for(let t in a){let s=parseInt($("#"+a[t]).find(".in").val()),i=parseInt($("#"+a[t]).find(".out").val());if(s>-1&&i>-1){let r=parseInt(a[t].split("_")[0]),n=parseInt(a[t].split("_")[1]);0===l&&(e.values.vs_p[r]=0,e.values.vs_av[r]=0,e.values.vs_a[r]=0,e.values.vs_p[n]=0,e.values.vs_av[n]=0,e.values.vs_a[n]=0),s>i&&(e.values.vs_p[r]+=3),s<i&&(e.values.vs_p[n]+=3),s===i&&(e.values.vs_p[r]++,e.values.vs_p[n]++),e.values.vs_av[r]+=s-i,e.values.vs_av[n]+=i-s,e.values.vs_a[r]+=s,e.values.vs_a[n]+=i,l++}}let r=[],n=["p","vs_p","vs_av","vs_a","av","a"];for(let t in e.teams){let s="";for(let a in n){let i=n[a];s+=e.values[i][t]+500}s+="."+t,r.push(s)}r.sort().reverse();for(let e in r)i.push(r[e].split(".")[1]);e.t_sort=i},nowDate:function(){let e=new Date,t=e.getDate();t<10&&(t="0"+t);let s=e.getMonth()+1;s<10&&(s="0"+s);let a=e.getHours();a<10&&(a="0"+a);let i=e.getMinutes();return i<10&&(i="0"+i),e=t+"."+s+"."+e.getFullYear()+" - "+a+":"+i},engine:function(e){if(!e.$route.params.id&&!e.$route.params.league)return window.location.href.split("?")[1]?(e.load=!0,!1):(this.goHome(),!1);let t=[];e.$route.params.league&&axios.get("https://lig123.firebaseio.com/id/"+e.$route.params.id+"/"+e.$route.params.league+".json").then(s=>{let a=s.data;if(e.scores.toString()!==a.scores.toString()){e.league=a.league,e.teams=a.teams,e.created_at=a.created_at,e.updated_at=a.updated_at,e.time1=a.match;for(let e=1;e<=parseInt(a.teams.length);e++)this.t_sort.push(e-1),t.push(0);setTimeout(function(){for(let e in a.scores)a.scores[e].split("-").length>1&&(document.getElementsByClassName("score-input")[2*e].value=a.scores[e].split("-")[0],document.getElementsByClassName("score-input")[2*e+1].value=a.scores[e].split("-")[1]);e.scores=a.scores},50),setTimeout(function(){e.load=!0},200),e.name=a.name,e.values.o=t,e.values.a=t,e.values.y=t,e.values.p=t,e.values.vs_p=t,e.values.vs_av=t,e.values.vs_a=t,e.values.av=t}}).catch(s=>{if(e.league=prompt("Lig adı nedir? ... Ligi"),null===e.league)return void this.goBack();let a=prompt("Kaç takım var? örn: 4");if(!(a>0))return void this.goBack();for(let s=1;s<=parseInt(a);s++)e.teams.push(prompt(s+". Takımın adı nedir?")),e.t_sort.push(s-1),t.push(0);let i=e.teams,l=[];for(let e in i)for(let t in i)if(e!==t){let s=0;if(l)for(let a in l)(l[a][0]===e&&l[a][1]===t||l[a][0]===t&&l[a][1]===e)&&s++;0===s&&l.push(this.suffle([e,t]))}l=e.suffle(l),e.time1=l,e.load=!0,e.created_at=e.nowDate(),e.updated_at=e.created_at;let r=(new Date).getTime(),n=!1;e.scores.length&&(n=e.scores),axios.put("https://lig123.firebaseio.com/id/"+e.$route.params.id+"/"+r+".json",{name:r,league:e.league,scores:n,teams:e.teams,match:e.time1,updated_at:e.created_at,created_at:e.created_at}).then(t=>{e.name=t.data.name,window.location.hash="#/"+e.$route.params.id+"/"+e.name}),e.values.o=t,e.values.a=t,e.values.y=t,e.values.p=t,e.values.vs_p=t,e.values.vs_av=t,e.values.vs_a=t,e.values.av=t}),e.$route.params.id&&!e.$route.params.league&&axios.get("https://lig123.firebaseio.com/id/"+e.$route.params.id+".json").then(t=>{let s=t.data,a={},i=[];for(let e in s)i.push(e);for(let e=i.length-1;e>=0;e--)a[i[e]]=s[i[e]];e.list=a,setTimeout(function(){e.load=!0},200)})}},watch:{scores(val){let matches=[],s=this,i=0,arr="[";for(let e in this.matches[0])matches.push(this.matches[0][e]);for(let e in this.matches[1])matches.push(this.matches[1][e]);for(let e in this.teams)arr+="0,";arr=arr.substr(0,arr.length-1),arr+="]",this.values={o:eval(arr),a:eval(arr),y:eval(arr),p:eval(arr),vs_p:eval(arr),vs_av:eval(arr),vs_a:eval(arr),av:eval(arr)};for(let e in matches)try{let t=this.teams[matches[e][0]],a=this.teams[matches[e][1]],l=document.getElementsByClassName("match")[i],r=l.getElementsByTagName("input")[0].value,n=l.getElementsByTagName("input")[1].value;r&&n&&(s.values.o[matches[e][0]]++,s.values.o[matches[e][1]]++,s.values.a[matches[e][0]]+=parseInt(r),s.values.a[matches[e][1]]+=parseInt(n),s.values.y[matches[e][0]]+=parseInt(n),s.values.y[matches[e][1]]+=parseInt(r),s.values.av[matches[e][0]]+=parseInt(r)-parseInt(n),s.values.av[matches[e][1]]+=parseInt(n)-parseInt(r),parseInt(r)>parseInt(n)&&(s.values.p[matches[e][0]]+=3),parseInt(r)<parseInt(n)&&(s.values.p[matches[e][1]]+=3),parseInt(r)===parseInt(n)&&(s.values.p[matches[e][0]]+=1,s.values.p[matches[e][1]]+=1)),i++}catch(e){}setTimeout(this.sort,100),axios.put("https://lig123.firebaseio.com/id/"+this.$route.params.id+"/"+s.name+".json",{name:s.name,league:s.league,scores:s.scores,teams:s.teams,match:s.time1,updated_at:s.nowDate(),created_at:s.created_at}).then(e=>{s.updated_at=e.data.updated_at,clearInterval(s.up),s.up=setInterval(function(){s.engine(s)},5e3)})}},mounted(){this.engine(this)}});